# About This Example
This example demonstrates interactive, basic positioning control of a servo axis using [AI Shell](https://github.com/PowerShell/AIShell) and **SingleMCController**.
The user experience depends on the chat AI model and prompt used with AI Shell.
You provide operational commands in natural language containing domain-specific terminology.
After configuring the context to generate appropriate operational code that uses SingleMCController, you give the operational command in a prompt.

UAMotionLink simply provides an interface for controlling motion FBs via an OPC UA server.
Therefore, you can achieve the same operations by implementing a client similar to SingleMCController with any OPC UA client.
This allows for a configuration using a Python-enabled OPC UA client and JupyterLab, for example.

You can control a servo via AI Shell as shown below.

![Servo Operation via AI Shell](../../images/control-with-ai-shell.gif)

## Objective
The purpose of UAMotionLinkLib is to eliminate the need for cumbersome IDE operations or in-place modifications for one-off servo operations required during commissioning or adjustments.
SingleMCController provides client functionality for the servo operation interface offered by UAMotionLinkLib, but it requires a PowerShell script for operation.
If you aren't familiar with PowerShell, creating these scripts may be time-consuming, and even if you are, it's still a tedious task.
Therefore, simply using SingleMCController alone does not fully meet the intended purpose of UAMotionLinkLib.
To address this, we use a CLI-based chat interface like AI Shell to dynamically generate and execute code from natural language commands.
This significantly improves operational efficiency and flexibility, thereby greatly enhancing the effectiveness of using UAMotionLinkLib.

Using SingleMCController for remote actuator control inherently carries risks.
You might think the risk is even greater when operating with code generated by a generative AI.
However, this risk is not a direct reflection of the generative AI's uncertainty.
It can be controlled by implementing appropriate behavior.
External motion commands, regardless of whether they come from a physical switch or a human, must be equally inspected.
If there are any deficiencies, the command should be rejected.
Furthermore, developers control which operations are permitted.

If the risk associated with UAMotionLinkLib's servo operation interface is unacceptable, it can be modified to an acceptable level.
Conversely, if more risk is acceptable, functions for servo readiness or continuous motion can be added, referencing existing interfaces.
Everything is up to the developer.

## Structure
The items other than the Sysmac project and `.env` file are only used for instructing the chat AI and are not strictly required.
Any configuration will work as long as the chat AI can properly generate code and AI Shell can execute it.

* **ExampleControlWithAIShell.smc2**   
    The Sysmac project used in this example.

* **context.md**   
    A document outlining general matters about the task.

* **machine.md**   
    A document describing the target device and axes. Used to provide the chat AI with domain-specific information.

* **.env.template**   
    A template for the `.env` file. Used to pass the OPC UA server endpoint and SingleMCController settings as environment variables.

## How to Use
Use AI Shell with this directory as the current directory.
The model used is `gemini-2.5-flash`.
Since the target is a chat AI, reproducibility cannot be guaranteed, but it is not difficult to achieve the intended outcome.
It is entirely possible for the generated script to have deficiencies.
When testing with an actual machine, ensure you have a way to stop or emergency stop the operation.

1.  **AI Shell Setup**   
    Refer to [Install AI Shell](https://learn.microsoft.com/en-us/powershell/utility-modules/aishell/install-aishell?view=ps-modules).

2.  **SingleMCController Setup**   
    Set up PwshOpcUaClient. Refer to [PwshOpcUaClient](https://github.com/kmu2030/PwshOpcUaClient).
    If targeting a controller, you must authorize PwshOpcUaClient's client certificate on the controller's OPC UA server.

3.  **Start the Simulator**   
    Open the Sysmac project in Sysmac Studio, then start and configure the simulator and OPC UA server.
    Refer to the manufacturer's manual for OPC UA server settings.
    Configure the OPC UA server to match the contents of `.env.template`.

4.  **Prepare the .env File**   
    Rename `.env.template` to `.env`.

5.  **Start AI Shell**   
    Launch Windows Terminal and start AI Shell with this directory as the current directory.

6. **Familiarize the Chat AI with the Context**   
    As shown in the image at the beginning, you interactively familiarize the chat AI with the context so that subsequent servo operations can be performed smoothly.
    If necessary, you should also change the system prompt.

7.  **Servo Operation**   
    Control the servo by giving commands in the prompt.
